---
title: cpm sync
description: "Regenerate symlinks for shared components"
---

## Usage

```bash
cpm sync [PROJECT_NAME] [OPTIONS]
```

## Description

Regenerates symlinks from project's `.claude/` directories to `shared/` based on dependencies in `project.json`. Also updates per-directory `.gitignore` files.

## Arguments

| Argument | Description |
|----------|-------------|
| `PROJECT_NAME` | Name of project to sync (optional if using `--all`) |

## Options

| Option | Short | Description |
|--------|-------|-------------|
| `--all` | `-a` | Sync all projects in the mono repo |

## Examples

### Sync single project

```bash
cpm sync my-project
```

### Sync all projects

```bash
cpm sync --all
```

Or:

```bash
cpm sync -a
```

## When to Use

<CardGroup cols={2}>
  <Card title="After Git Clone" icon="code-branch">
    Symlinks aren't committed to git - regenerate them after cloning
  </Card>
  <Card title="After Manual Edit" icon="pen">
    After manually editing `project.json` dependencies
  </Card>
  <Card title="Broken Symlinks" icon="link-slash">
    When symlinks are broken or missing
  </Card>
  <Card title="After Moving Files" icon="folder-arrow-up">
    After reorganizing the shared directory
  </Card>
</CardGroup>

## What Happens

1. **Read** `project.json` dependencies
2. **Remove** existing symlinks in `.claude/{skills,agents,hooks,rules}/`
3. **Create** fresh symlinks to `shared/` components
4. **Update** per-directory `.gitignore` files

## Output

```bash
$ cpm sync my-project
✓ my-project: synced 3 links
  ✓ skills/code-review
  ✓ skills/testing
  ✓ agents/debugger
```

### Missing components

```bash
$ cpm sync my-project
✓ my-project: synced 2 links
  ✓ skills/code-review
  ✓ skills/testing
! my-project: 1 missing components
  ! agents/nonexistent
```

### No dependencies

```bash
$ cpm sync my-project
my-project: no dependencies to sync
```

## Workflow

### After cloning a repository

```bash
git clone https://github.com/org/mono-repo.git
cd mono-repo
cpm sync --all
```

### CI/CD setup

<Tabs>
  <Tab title="Python">
    ```yaml
    # .github/workflows/setup.yml
    steps:
      - uses: actions/checkout@v4
      - name: Install CPM
        run: pip install cpm
      - name: Sync symlinks
        run: cpm sync --all
    ```
  </Tab>
  <Tab title="TypeScript">
    ```yaml
    # .github/workflows/setup.yml
    steps:
      - uses: actions/checkout@v4
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
      - name: Install CPM
        run: npm install -g cpm
      - name: Sync symlinks
        run: cpm sync --all
    ```
  </Tab>
  <Tab title="TypeScript (npx)">
    ```yaml
    # .github/workflows/setup.yml
    steps:
      - uses: actions/checkout@v4
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
      - name: Sync symlinks
        run: npx cpm sync --all
    ```
  </Tab>
</Tabs>

<Note>
Local (project-specific) components are not affected by sync. Only shared component symlinks are managed.
</Note>
